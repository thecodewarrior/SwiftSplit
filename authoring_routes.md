# Route JSON
Routes are configured using a JSON file and use "events" generated by SwiftSplit. 

Here's an example for Old Site Any%:
```json
{
    "useFileTime": false,
    "reset": "reset chapter",
    "route": [
        "enter chapter 2 # Start",
        "d8 > d3 # - Mirror",
        "3x > 3 # Intervention",
        "10 > 2 # - Escape",
        "13 > end_0 # Awake",
        "complete chapter 2"
    ]
}
```

A route consists of a "reset" event and a list of "route" events. SwiftSplit expects route events in a specific order
and triggers splits on those events. The reset event can trigger at any point during the route and will instruct
LiveSplit to reset the run. There are mechanisms in place to allow leaving a chapter mid-run (either via Save and Quit
or Return to Map). See the [Expected Resets](#expected-resets) section for more on that.

## Events
Events are triggered when SwiftSplit observes a change in the game state, which is checked 30 times every second. A 
single event may have multiple variants, generally with differing levels of specificity (e.g. `leave chapter`, 
`leave chapter 1`, and `leave a-side 1`).

Note that the *exact* text of an event is important. Spaces and capitalization have to match, with a couple additions:
- Whitespace *around* an event doesn't matter. (e.g. `"leave chapter"` is equivalent to `"    leave chapter "`)
- Inserting an exclamation point (`!`) at the beginning of an event will cause that event to be "silent" and not trigger 
  a split. This can be useful for situations like [expected resets](#expected-resets).
- Anything after `#` will be trimmed off. This can be useful for explaining events.
- If after applying the previous two rules the event is empty, it's simply ignored. (e.g. `! # comment` will be ignored)

SwiftSplit has an "Event Stream" panel that displays events as they are triggered, which can be useful when creating 
route files. (You can copy the text out of the panel to paste directly into the route file).

### Chapter start/end events
- `leave chapter` - Triggered when leaving any chapter (either by restarting the chapter, returning to the map, or
  using "Save and Quit")
- `leave chapter <n>` - Triggered when leaving chapter `<n>`
- `enter chapter` - Triggered when any chapter is entered
- `enter chapter <n>` - Triggered when chapter `<n>` is entered
- `complete chapter` - Triggered when any chapter is completed
- `complete chapter <n>` - Triggered when chapter `<n>` is completed
- **A-side specific:**
  - `enter a-side <n>` - Triggered when chapter `<n>`'s A-side is entered
  - `leave a-side <n>` - Triggered when leaving chapter `<n>`'s A-side
  - `complete a-side <n>` - Triggered when chapter `<n>`'s A-side is completed
- **B-side specific:**
  - `enter b-side <n>` - Triggered when chapter `<n>`'s B-side is entered
  - `leave b-side <n>` - Triggered when leaving chapter `<n>`'s B-side
  - `complete b-side <n>` - Triggered when chapter `<n>`'s B-side is completed
- **C-side specific:**
  - `enter c-side <n>` - Triggered when chapter `<n>`'s C-side is entered
  - `leave c-side <n>` - Triggered when leaving chapter `<n>`'s C-side
  - `complete c-side <n>` - Triggered when chapter `<n>`'s C-side is completed

### Screen transition event
- `<from screen> > <to screen>` - Triggered when transitioning between two screens (you can find the screen IDs by
  enabling debug and hovering over the screen in the map editor.)

### Collectable events
- **Cassettes:**
  - `collect cassette` - Triggered when any cassette is collected
  - `collect chapter <n> cassette` - Triggered when the cassette in the specified chapter is collected
  - `<n> total cassettes` - Triggered when a cassette is collected. `<n>` is the total number of cassettes collected in
    the current file
- **Heart Gems:**
  - `collect heart` - Triggered when any heart gem is collected
  - `collect chapter <n> heart` - Triggered when the heart gem in the specified chapter is collected
  - `<n> total hearts` - Triggered when a heart gem is collected. `<n>` is the total number of heart gems collected in 
    the current file
- **Strawberries:**
  - `collect strawberry` - Triggered when any strawberry is collected
  - `<n> chapter strawberries` - Triggered when a total of `<n>` strawberries are collected in a chapter
  - `<n> file strawberries` - Triggered when a total of `<n>` strawberries are collected in the file

## Return to Map & Save and Quit

Without the proper route file, both of these count as resetting a chapter. It's impossible for SwiftSplit to tell the 
difference between a reset, return to map, or save and quit. To get around this, you can define in your route where
leaving the chapter is *expected.* 

Here's what the reset for the 1A might look like:
```json
"route": [
    "enter chapter 1 # Start",
    "5 > 6 # Crossing",
    "!collect heart",
    "!leave chapter",
    "9 > 9b # Chasm",
    "complete chapter 1"
]
```

The reason we put `!collect heart` before `!leave chapter` is because any time that SwiftSplit is waiting for you to 
leave the chapter *you can not automatically reset the run.* Any attempt to restart the run will just result in 
progressing through the route. By putting the collect heart event before the leave chapter event we make sure that 
SwiftSplit only starts waiting for the leave event right before we do it. 

For restarting after collecting berries you'd want to have two events: one when you enter the room you'll save and quit
in, and the next when you collect the berry:

```json
"route": [
    "...",
    "!a00 > a03",
    "!collect strawberry",
    "!leave chapter",
    "..."
]
```
